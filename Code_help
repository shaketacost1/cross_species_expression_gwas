TARGET=CTCF ASSEMBLY=GRCh38; curl -sG 'https://www.encodeproject.org/search/' \
  --data-urlencode type=File \
  --data-urlencode assay_title='ChIP-seq' \
  --data-urlencode target.label="$TARGET" \
  --data-urlencode assembly="$ASSEMBLY" \
  --data-urlencode status=released \
  --data-urlencode file_format=narrowPeak \
  --data-urlencode format=json \
  --data-urlencode limit=all \
  -H 'Accept: application/json' \
| jq -r '.["@graph"][].href' \
| sed 's|^|https://www.encodeproject.org|g' > enc_CTCF_urls.txt

wc -l enc_${TARGET}_urls.txt




mkdir -p enc_CTCF_raw
wget -c -i enc_CTCF_urls.txt -P enc_CTCF_raw
ls -lh enc_CTCF_raw | head



# set variables (optional)
TARGET=CTCF
ASSEMBLY=GRCh38

# Query ENCODE Files for CTCF narrowPeaks on GRCh38
curl -sG "https://www.encodeproject.org/search/" \
  --data-urlencode "type=File" \
  --data-urlencode "file_format=bed+narrowPeak" \
  --data-urlencode "output_type=peaks" \
  --data-urlencode "assembly=${ASSEMBLY}" \
  --data-urlencode "target.label=${TARGET}" \
  --data-urlencode "status=released" \
  --data-urlencode "format=json" \
  --data-urlencode "limit=all" \
  -H "Accept: application/json" \
| tee enc_${TARGET}_raw.json \
| jq -r '.["@graph"][].href' \
| sed 's|^|https://www.encodeproject.org|g' > enc_${TARGET}_urls.txt

# Sanity check: how many files?
jq '.["@graph"] | length' enc_${TARGET}_raw.json
wc -l enc_${TARGET}_urls.txt

# Peek at first few URLs
head enc_${TARGET}_urls.txt

# Download them
mkdir -p enc_${TARGET}_raw
wget -c -i enc_${TARGET}_urls.txt -P enc_${TARGET}_raw
