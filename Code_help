# In your human/ directory
TARGET=CTCF
ASSEMBLY=GRCh38

# 1) Get CTCF ChIP-seq experiments (released)
curl -sG 'https://www.encodeproject.org/search/' \
  --data-urlencode "type=Experiment" \
  --data-urlencode "assay_title=ChIP-seq" \
  --data-urlencode "target.label=${TARGET}" \
  --data-urlencode "status=released" \
  --data-urlencode "limit=all" \
  --data-urlencode "format=json" \
  -H 'Accept: application/json' \
  -o enc_${TARGET}_experiments.json

# 2) From each experiment, collect Files that are GRCh38 narrowPeak peaks (bed or bigBed)
jq -r '
  .["@graph"][]
  | .files[]
  | select(
      (.assembly == "'${ASSEMBLY}'")
      and (.output_type == "peaks")
      and ((.file_type == "bed narrowPeak") or (.file_type == "bigBed narrowPeak"))
    )
  | .href
' enc_${TARGET}_experiments.json \
| sed 's|^|https://www.encodeproject.org|g' > enc_${TARGET}_urls.txt

# 3) Sanity check counts & first few
wc -l enc_${TARGET}_urls.txt
head enc_${TARGET}_urls.txt

# 4) Download
mkdir -p enc_${TARGET}_raw
wget -c -i enc_${TARGET}_urls.txt -P enc_${TARGET}_raw
